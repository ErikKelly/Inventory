(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{711:(e,t,r)=>{Promise.resolve().then(r.bind(r,3278))},3278:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(5155),a=r(2115);function n(e){let{sheetId:t,tabNames:r}=e,[n,l]=(0,a.useState)([]),[i,c]=(0,a.useState)(0),[o,d]=(0,a.useState)(!0),[m,h]=(0,a.useState)(null),[u,g]=(0,a.useState)(""),[x,p]=(0,a.useState)(null),[b,f]=(0,a.useState)(!1),[v,j]=(0,a.useState)({key:null,direction:"ascending"}),y=(0,a.useMemo)(()=>r?"string"==typeof r?r.split(",").map(e=>e.trim()):r:[],[r]);(0,a.useEffect)(()=>{let e=()=>{f(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,a.useEffect)(()=>{if(!t){h("Missing required prop: sheetId"),d(!1);return}if(!r||Array.isArray(y)&&0===y.length){h("Missing required prop: tabNames"),d(!1);return}N()},[t,y]);let N=async()=>{try{let e=[];for(let r of y)try{let s="https://docs.google.com/spreadsheets/d/".concat(t,"/gviz/tq?sheet=").concat(encodeURIComponent(r),"&tqx=out:json"),a=await fetch(s),n=await a.text();if(!n.includes("table")){console.warn('Sheet "'.concat(r,'" not found or empty'));continue}let l=n.substring(n.indexOf("(")+1,n.lastIndexOf(")")),i=JSON.parse(l),c=i.table.cols.map((e,t)=>e.label&&""!==e.label.trim()?e.label:e.id||"Column_".concat(t+1)),o=i.table.rows.map(e=>{let t={};return c.forEach((r,s)=>{var a;let n=null===(a=e.c[s])||void 0===a?void 0:a.v;t[r]=null==n?"":String(n)}),t});e.push({name:r,items:o})}catch(e){console.error("Error loading sheet ".concat(r,":"),e)}0===e.length?h("No sheets could be loaded. Check your sheet ID and tab names."):l(e),d(!1)}catch(e){h(e.message),d(!1)}},w=n[i]||{name:"",items:[]},k=e=>{let t="ascending";v.key===e&&"ascending"===v.direction&&(t="descending"),j({key:e,direction:t})},C=(0,a.useMemo)(()=>{let e=w.items;return u&&(e=w.items.filter(e=>Object.values(e).some(e=>e.toLowerCase().includes(u.toLowerCase())))),v.key&&(e=[...e].sort((e,t)=>{let r=e[v.key],s=t[v.key],a=parseFloat(r),n=parseFloat(s);return isNaN(a)||isNaN(n)?r<s?"ascending"===v.direction?-1:1:r>s?"ascending"===v.direction?1:-1:0:"ascending"===v.direction?a-n:n-a})),e},[w.items,u,v]);if(o)return(0,s.jsx)("div",{className:"p-4",children:"Loading collections..."});if(m)return(0,s.jsxs)("div",{className:"p-4 text-red-500",children:["Error: ",m]});if(0===n.length)return(0,s.jsx)("div",{className:"p-4",children:"No data found"});let S=w.items.length>0?Object.keys(w.items[0]):[],E=e=>{if(!e||"string"!=typeof e)return!1;let t=!!e.match(/\.(jpeg|jpg|gif|png|webp)$/i),r=e.startsWith("./public/images/")||e.startsWith("/public/images/")||e.startsWith("/images/"),s=e.includes("imgur.com")||e.includes("cloudinary.com")||e.startsWith("http")&&e.includes("image");return t||r||s},I=e=>e?e.startsWith("./public/")?e.replace("./public",""):e:"";return(0,s.jsxs)("div",{className:"relative pt-2 pb-8",children:[n.length>1&&(0,s.jsx)("div",{className:"border-b border-gray-200 mb-4 mx-4",children:(0,s.jsx)("ul",{className:"flex flex-wrap -mb-px",children:n.map((e,t)=>(0,s.jsx)("li",{className:"mr-2",children:(0,s.jsx)("button",{onClick:()=>{c(t),g(""),j({key:null,direction:"ascending"})},className:"inline-block p-4 border-b-2 rounded-t-lg ".concat(t===i?"border-nav-bg text-nav-bg":"border-transparent hover:text-gray-600 hover:border-gray-300"),children:e.name})},e.name))})}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("input",{type:"text",placeholder:"Search ".concat(w.name,"..."),value:u,onChange:e=>g(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-md w-full max-w-md"})}),(0,s.jsxs)("div",{className:"text-sm text-gray-500 mb-2",children:["Showing ",C.length," of ",w.items.length," items"]})]}),(0,s.jsx)("div",{className:"overflow-x-auto px-4",children:(0,s.jsxs)("table",{className:"min-w-full bg-white border border-gray-300",children:[(0,s.jsx)("thead",{children:(0,s.jsx)("tr",{children:S.map(e=>(0,s.jsx)("th",{className:"py-2 px-4 border-b border-gray-300 text-left cursor-pointer hover:bg-gray-100",onClick:()=>k(e),children:(0,s.jsxs)("div",{className:"flex items-center",children:[e,v.key===e&&(0,s.jsx)("span",{className:"ml-1",children:"ascending"===v.direction?"↑":"↓"})]})},e))})}),(0,s.jsx)("tbody",{children:C.length>0?C.map((e,t)=>(0,s.jsx)("tr",{className:t%2==0?"bg-gray-50":"bg-white",children:S.map(t=>(0,s.jsx)("td",{className:"py-2 px-4 border-b border-gray-300",children:E(e[t])?(0,s.jsx)("div",{className:"w-24 h-24 flex items-center justify-center relative",children:(0,s.jsx)("img",{src:I(e[t]),alt:"Product image",className:"max-w-full max-h-full object-contain cursor-pointer",width:"96",height:"96",onClick:()=>p(I(e[t])),onError:r=>{console.log("Image load error for URL:",e[t]);let s=r.currentTarget.parentNode;s&&(s.innerHTML="<span class='text-sm text-gray-500'>Image unavailable</span>")}})}):null===e[t]?"":e[t]},t))},t)):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:S.length,className:"py-4 px-4 text-center text-gray-500",children:"No matching items found"})})})]})}),x&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4",onClick:()=>p(null),children:(0,s.jsx)("div",{className:"bg-white p-4 rounded-lg max-w-4xl max-h-[90vh] overflow-auto shadow-xl",onClick:e=>e.stopPropagation(),children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("button",{className:"absolute top-2 right-2 bg-white rounded-full w-8 h-8 flex items-center justify-center text-gray-700 hover:text-gray-900 hover:bg-gray-200",onClick:()=>p(null),"aria-label":"Close preview",children:(0,s.jsx)("span",{className:"text-2xl",children:"\xd7"})}),(0,s.jsx)("img",{src:x,alt:"Preview",className:"max-w-full max-h-[80vh] object-contain"})]})})})]})}var l=r(5903);function i(){return l.K6?l.Pv?(0,s.jsx)(n,{sheetId:l.K6,tabNames:l.Pv}):(0,s.jsx)("div",{className:"p-4 text-red-500",children:"Error: Sheet tab names are not configured"}):(0,s.jsx)("div",{className:"p-4 text-red-500",children:"Error: Sheet ID is not configured"})}},5903:(e,t,r)=>{"use strict";r.d(t,{K6:()=>a,Pv:()=>n,VG:()=>l,yy:()=>s});let s="EK's Cards",a="1gUdbhzWjdRmcet7CX592wJ25GN_CW-k1J08wERqzAGY",n="Graded Cards, Sets, Raw Cards",l="rgb(75, 31, 31)"}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(711)),_N_E=e.O()}]);