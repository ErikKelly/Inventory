(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{711:(e,t,r)=>{Promise.resolve().then(r.bind(r,3278))},3278:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(5155),a=r(2115),n=r(5565);function i(e){let{sheetId:t,tabNames:r}=e,[i,l]=(0,a.useState)([]),[c,o]=(0,a.useState)(0),[d,m]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null),[g,p]=(0,a.useState)(""),[x,b]=(0,a.useState)({key:null,direction:"ascending"}),f=(0,a.useMemo)(()=>r?"string"==typeof r?r.split(",").map(e=>e.trim()):r:[],[r]);(0,a.useEffect)(()=>{if(!t){h("Missing required prop: sheetId"),m(!1);return}if(!r||Array.isArray(f)&&0===f.length){h("Missing required prop: tabNames"),m(!1);return}v()},[t,f]);let v=async()=>{try{let e=[];for(let r of f)try{let s="https://docs.google.com/spreadsheets/d/".concat(t,"/gviz/tq?sheet=").concat(encodeURIComponent(r),"&tqx=out:json"),a=await fetch(s),n=await a.text();if(!n.includes("table")){console.warn('Sheet "'.concat(r,'" not found or empty'));continue}let i=n.substring(n.indexOf("(")+1,n.lastIndexOf(")")),l=JSON.parse(i),c=l.table.cols.map((e,t)=>e.label&&""!==e.label.trim()?e.label:e.id||"Column_".concat(t+1)),o=l.table.rows.map(e=>{let t={};return c.forEach((r,s)=>{e.c&&e.c[s]&&void 0!==e.c[s].v?t[r]=String(e.c[s].v):t[r]=""}),t});e.push({name:r,items:o})}catch(e){console.error("Error loading sheet ".concat(r,":"),e)}0===e.length?h("No sheets could be loaded. Check your sheet ID and tab names."):l(e),m(!1)}catch(e){h(e.message),m(!1)}},y=i[c]||{name:"",items:[]},j=e=>{let t="ascending";x.key===e&&"ascending"===x.direction&&(t="descending"),b({key:e,direction:t})},N=(0,a.useMemo)(()=>{let e=y.items;return g&&(e=y.items.filter(e=>Object.values(e).some(e=>e.toLowerCase().includes(g.toLowerCase())))),x.key&&(e=[...e].sort((e,t)=>{let r=e[x.key],s=t[x.key],a=parseFloat(r),n=parseFloat(s);return isNaN(a)||isNaN(n)?r<s?"ascending"===x.direction?-1:1:r>s?"ascending"===x.direction?1:-1:0:"ascending"===x.direction?a-n:n-a})),e},[y.items,g,x]);if(d)return(0,s.jsx)("div",{className:"p-4",children:"Loading collections..."});if(u)return(0,s.jsxs)("div",{className:"p-4 text-red-500",children:["Error: ",u]});if(0===i.length)return(0,s.jsx)("div",{className:"p-4",children:"No data found"});let w=y.items.length>0?Object.keys(y.items[0]):[],k=e=>{if(!e||"string"!=typeof e)return!1;let t=!!e.match(/\.(jpeg|jpg|gif|png|webp)$/i),r=e.includes("drive.google.com"),s=e.includes("imgur.com")||e.includes("cloudinary.com")||e.startsWith("http")&&e.includes("image");return t||r||s},S=e=>{if(e.includes("drive.google.com/file/d/"))try{var t;let r=null===(t=e.match(/\/file\/d\/([^\/]+)/))||void 0===t?void 0:t[1];if(r)return"https://drive.google.com/uc?export=view&id=".concat(r)}catch(e){console.error("Error parsing Google Drive URL:",e)}return e};return(0,s.jsxs)("div",{className:"relative pt-2 pb-8",children:[i.length>1&&(0,s.jsx)("div",{className:"border-b border-gray-200 mb-4 mx-4",children:(0,s.jsx)("ul",{className:"flex flex-wrap -mb-px",children:i.map((e,t)=>(0,s.jsx)("li",{className:"mr-2",children:(0,s.jsx)("button",{onClick:()=>{o(t),p(""),b({key:null,direction:"ascending"})},className:"inline-block p-4 border-b-2 rounded-t-lg ".concat(t===c?"border-nav-bg text-nav-bg":"border-transparent hover:text-gray-600 hover:border-gray-300"),children:e.name})},e.name))})}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("input",{type:"text",placeholder:"Search ".concat(y.name,"..."),value:g,onChange:e=>p(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-md w-full max-w-md"})}),(0,s.jsxs)("div",{className:"text-sm text-gray-500 mb-2",children:["Showing ",N.length," of ",y.items.length," items"]})]}),(0,s.jsx)("div",{className:"overflow-x-auto px-4",children:(0,s.jsxs)("table",{className:"min-w-full bg-white border border-gray-300",children:[(0,s.jsx)("thead",{children:(0,s.jsx)("tr",{children:w.map(e=>(0,s.jsx)("th",{className:"py-2 px-4 border-b border-gray-300 text-left cursor-pointer hover:bg-gray-100",onClick:()=>j(e),children:(0,s.jsxs)("div",{className:"flex items-center",children:[e,x.key===e&&(0,s.jsx)("span",{className:"ml-1",children:"ascending"===x.direction?"↑":"↓"})]})},e))})}),(0,s.jsx)("tbody",{children:N.length>0?N.map((e,t)=>(0,s.jsx)("tr",{className:t%2==0?"bg-gray-50":"bg-white",children:w.map(t=>(0,s.jsx)("td",{className:"py-2 px-4 border-b border-gray-300",children:k(e[t])?(0,s.jsx)("div",{className:"w-24 h-24 flex items-center justify-center",children:(0,s.jsx)(n.default,{src:S(e[t]),alt:"Product image",className:"max-w-full max-h-full object-contain",width:96,height:96,onError:e=>{let t=e.currentTarget.parentNode;t&&t instanceof HTMLElement&&(t.innerHTML="<span class='text-sm text-gray-500'>Image unavailable</span>")}})}):e[t]},t))},t)):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:w.length,className:"py-4 px-4 text-center text-gray-500",children:"No matching items found"})})})]})})]})}var l=r(5903);function c(){return l.K6?l.Pv?(0,s.jsx)(i,{sheetId:l.K6,tabNames:l.Pv}):(0,s.jsx)("div",{className:"p-4 text-red-500",children:"Error: Sheet tab names are not configured"}):(0,s.jsx)("div",{className:"p-4 text-red-500",children:"Error: Sheet ID is not configured"})}},5903:(e,t,r)=>{"use strict";r.d(t,{K6:()=>a,Pv:()=>n,VG:()=>i,yy:()=>s});let s="EK's Cards",a="14qJJYCwu5_aaS4ecJdDG7juKcEssWETr2-dicbcSGjw",n="Tab1,Tab2,Tab3",i="rgb(75, 31, 31)"}},e=>{var t=t=>e(e.s=t);e.O(0,[565,441,517,358],()=>t(711)),_N_E=e.O()}]);