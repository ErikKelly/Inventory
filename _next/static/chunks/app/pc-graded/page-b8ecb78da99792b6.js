(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[292],{1655:(e,t,s)=>{Promise.resolve().then(s.bind(s,7503))},9203:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(5155),a=s(2115),l=s(5565);function n(e){let{sheetId:t,sheetName:s,title:n}=e,[i,c]=(0,a.useState)([]),[d,o]=(0,a.useState)(!0),[h,g]=(0,a.useState)(null),[m,u]=(0,a.useState)(""),[x,p]=(0,a.useState)({key:null,direction:"ascending"});(0,a.useEffect)(()=>{fetch("https://docs.google.com/spreadsheets/d/".concat(t,"/gviz/tq?sheet=").concat(s,"&tqx=out:json")).then(e=>e.text()).then(e=>{let t=JSON.parse(e.substring(e.indexOf("(")+1,e.lastIndexOf(")"))),s=t.table.cols.map(e=>e.label);c(t.table.rows.map(e=>{let t={};return s.forEach((s,r)=>{var a,l;t[s]=(null===(l=e.c[r])||void 0===l?void 0:null===(a=l.v)||void 0===a?void 0:a.toString())||""}),t})),o(!1)}).catch(e=>{console.error("Error fetching data:",e),g(e.message),o(!1)})},[t,s]);let b=e=>{let t="ascending";x.key===e&&"ascending"===x.direction&&(t="descending"),p({key:e,direction:t})},j=(0,a.useMemo)(()=>{let e=i;return m&&(e=i.filter(e=>Object.values(e).some(e=>e.toLowerCase().includes(m.toLowerCase())))),x.key&&(e=[...e].sort((e,t)=>{let s=e[x.key],r=t[x.key],a=parseFloat(s),l=parseFloat(r);return isNaN(a)||isNaN(l)?s<r?"ascending"===x.direction?-1:1:s>r?"ascending"===x.direction?1:-1:0:"ascending"===x.direction?a-l:l-a})),e},[i,m,x]);if(d)return(0,r.jsx)("div",{className:"p-4",children:"Loading collection..."});if(h)return(0,r.jsxs)("div",{className:"p-4 text-red-500",children:["Error: ",h]});let N=i.length>0?Object.keys(i[0]):[],f=e=>{if(!e||"string"!=typeof e)return!1;let t=!!e.match(/\.(jpeg|jpg|gif|png|webp)$/i),s=e.startsWith("http")&&e.includes("image");return t||s};return(0,r.jsxs)("div",{className:"relative py-5",children:[(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:n}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("input",{type:"text",placeholder:"Search collection...",value:m,onChange:e=>u(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-md w-full max-w-md"})}),(0,r.jsxs)("div",{className:"text-sm text-gray-500 mb-2",children:["Showing ",j.length," of ",i.length," items"]})]}),(0,r.jsx)("div",{className:"overflow-x-auto px-4",children:(0,r.jsxs)("table",{className:"min-w-full bg-white border border-gray-300",children:[(0,r.jsx)("thead",{children:(0,r.jsx)("tr",{children:N.map(e=>(0,r.jsx)("th",{className:"py-2 px-4 border-b border-gray-300 text-left cursor-pointer hover:bg-gray-100",onClick:()=>b(e),children:(0,r.jsxs)("div",{className:"flex items-center",children:[e,x.key===e&&(0,r.jsx)("span",{className:"ml-1",children:"ascending"===x.direction?"↑":"↓"})]})},e))})}),(0,r.jsx)("tbody",{children:j.length>0?j.map((e,t)=>(0,r.jsx)("tr",{className:t%2==0?"bg-gray-50":"bg-white",children:N.map(t=>(0,r.jsx)("td",{className:"py-2 px-4 border-b border-gray-300",children:f(e[t])?(0,r.jsx)(l.default,{src:e[t],alt:"Product image",className:"w-24 h-24 object-contain",width:96,height:96}):e[t]},t))},t)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:N.length,className:"py-4 px-4 text-center text-gray-500",children:"No matching items found"})})})]})})]})}},7503:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var r=s(5155),a=s(9203);function l(){return(0,r.jsx)(a.A,{sheetId:"1gUdbhzWjdRmcet7CX592wJ25GN_CW-k1J08wERqzAGY",sheetName:"PC-Graded",title:"Personal Collection - Graded"})}}},e=>{var t=t=>e(e.s=t);e.O(0,[565,441,517,358],()=>t(1655)),_N_E=e.O()}]);